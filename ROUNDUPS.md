# Starling Round-Up feature

To perform round ups on transactions between two dates we need to perform the following steps:

1. Get the start and end dates from the user (date picker fields, command line arguments etc..).
2. Call the **"Get Accounts"** endpoint (`GET /api/v2/accounts`).
3. Call the **"Get Savings Goals"** endpoint (`GET /api/v2/account/{accountUid}/savings-goals`).
4. Create a new savings goal if one does not already exist by calling the **`Create a savings goal`**
   endpoint (`PUT /api/v2/account/{accountUid}/savings-goals`).
6. Call the **"Get Transactions Between"**
   endpoint (`GET /api/v2/feed/account/{accountUid}/category/{categoryUid}/transactions-between`).
7. go through the list of transactions returned and round up the amounts.
8. Call the **"Add Money To Savings Goal"**
   endpoint (`PUT /api/v2/account/{accountUid}/savings-goals/{savingsGoalUid}/add-money/{transferUid}`).

### Get Accounts

To get the **`accountUid`** and **`categoryUid`** that we will use in the get transactions call, we need to call the **"
Get the accounts associated with an account holder"** endpoint (`GET /api/v2/accounts`).

This endpoint does not need any parameters. It returns all of the accounts that are available depending on the
authentication method used (Personal access token / OAuth / Sandpit).

### Get Transactions

Looking through the API documentation at [Starling Developers](https://developer.starlingbank.com/docs), we can see that
to round up transactions we need to call the **"Get Transactions Between"**
endpoint (`GET /api/v2/feed/account/{accountUid}/category/{categoryUid}/transactions-between`). This will return all of
the transactions between the given two dates. we can then iterate through them and calulcate the round up amount for
those transactions.

This endpoint needs the following parameters:

1. `accountUid`: obtained from the get accounts call.
2. `categoryUid`: obtained from the get accounts call as the `defaultCategory` field.
3. `startDate`: This needs to get specified by the user.
4. `endDate`: This needs to get specified by the user.

### Get Savings Goals

To get the **Savings Goals** we call the **"Get all savings goals"**
endpoint (`GET /api/v2/account/{accountUid}/savings-goals`)

This endpoint needs the following parameters:

1. `accountUid`: this is the UID of the account (obtained above)

### Create Savings Goal

if a round up savings goal does not exist, we need to create it. This is done by calling the **`Create a savings goal`**
endpoint (`PUT /api/v2/account/{accountUid}/savings-goals`).

This endpoint requires the `accountUid` parameter and it also requires a JSON body that specifies the details of the
savings goal to create. This is the sample from the API documentation page:

```json
{
  "name": "Trip to Paris",
  "currency": "GBP",
  "target": {
    "currency": "GBP",
    "minorUnits": 123456
  },
  "base64EncodedPhoto": "string"
}
```

The minimal JSON object that we can send in to the endpoint contains just a name and a currency :

```json
{
  "name": "Round Ups",
  "currency": "GBP"
}
```

### Transfer Money To Savings Goal

Once we have calculated the amount to transfer into the round up savings goal we will need to call the **"Add money into
a savings goal"** endpoint (`PUT /api/v2/account/{accountUid}/savings-goals/{savingsGoalUid}/add-money/{transferUid}`)

This endpoint needs the following parameters:

1. `accountUid`: this is the UID of the account to transfer the money from (obtained as detailed above)
2. `savingsGoalUid`: This is the UID of the **Savings Goal** to transfer the money to
3. `transferUid`: This is a unique uuid that is generated by us (using `UUID.randomUUID()`) and can be used to identify
   the transfer transaction.